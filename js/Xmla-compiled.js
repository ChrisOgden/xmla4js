(function(w){function S(a){var e,c,d,f=!1,g=function(){f=!0;switch(e.readyState){case 0:u(a.aborted)&&a.aborted(e);break;case 4:if(200===e.status)a.complete(e);else{var c=b.Exception._newError("HTTP_ERROR","_ajax",{request:a,status:this.status,statusText:this.statusText});a.error(c)}}};e=A();c=["POST",a.url,a.async];a.username&&a.password&&(c=c.concat([a.username,a.password]));e.timeout=a.timeout;e.open.apply(e,c);e.onreadystatechange=g;e.setRequestHeader("Accept","text/xml, application/xml, application/soap+xml");
e.setRequestHeader("Content-Type","text/xml");if(c=a.headers)for(d in c)e.setRequestHeader(d,c[d]);e.send(a.data);!a.async&&!f&&g.call(e);return e}function i(a){return"undefined"===typeof a}function q(a){return a&&a.constructor===Array}function u(a){return"function"===typeof a}function D(a){return a&&"object"===typeof a}function E(a){"string"===typeof a&&(a=a.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"));return a}function M(a){return a.replace(/_x(\d\d\d\d)_/g,function(a,b){return String.fromCharCode(parseInt(b,
16))})}function F(a,b,c){a=a.childNodes;if(!a)return b;for(var d,f=0,g=a.length;f<g;f++)d=a[f],c&&!0===c.call(null,d)&&b.push(d),F(d,b,c)}function r(a){var b;r=b=i(a.innerText)?i(a.textContent)?i(a.nodeTypedValue)?a.normalize?function(a){a.normalize();return a.firstChild?a.firstChild.data:null}:function(a){var b=[],e=a.childNodes,g,j=e?e.length:0;for(g=0;g<j;g++)a=e[g],null!==a.data&&b.push(a.data);return b.length?b.join(""):null}:function(a){return a.nodeTypedValue}:function(a){return a.textContent}:
function(a){return a.innerText};return b(a)}function G(a,b,c,d){d||(d="");var f,g,j,t,k,l="\n"+d+"<"+a+">";if(c){l+="\n"+d+" <"+b+">";for(t in c)if(c.hasOwnProperty(t)){k=c[t];l+="\n"+d+"  <"+t+">";if(q(k)){f=k.length;for(g=0;g<f;g++)j=k[g],l+="<Value>"+E(j)+"</Value>"}else l+=E(k);l+="</"+t+">"}l+="\n"+d+" </"+b+">"}return l+("\n"+d+"</"+a+">")}function h(a,b,c){b&&!a&&(a={});for(var d in b)if(b.hasOwnProperty(d)&&(c||i(a[d])))a[d]=b[d];return a}function T(a){function b(){o.push(k);var a=new function(){};
a.constructor.prototype=k;k=new a.constructor;p.namespaces=k;l=!0}function c(a){var b="",e,c;c=0;for(var d=/&((#x([\dA-Fa-f]+))|(\w+));/g;e=d.exec(a);){b+=a.substr(c,e.index-c);if(c=e[3])b+=String.fromCharCode(parseInt(c,16));else if(c=e[4])switch(c){case "lt":b+="<";break;case "gt":b+=">";break;case "amp":b+="&";break;case "apos":b+="'";break;case "quot":b+='"';break;default:throw"Don't recognize named entity "+c;}c=d.lastIndex}return b+=a.substr(c)}var d=/<(((([\w\-\.]+):)?([\w\-\.]+))([^>]+)?|\/((([\w\-\.]+):)?([\w\-\.]+))|\?(\w+)([^\?]+)?\?|(!--([^\-]|-[^\-])*--))>|([^<>]+)/ig,
f,g,j,t,k={"":""},l,h,m,i,o=[],n,p=null;for(m=i={nodeType:9,childNodes:[]};f=d.exec(a);){p=null;if(g=f[5]){l=!1;n=p={offset:f.index,parentNode:i,nodeType:1,nodeName:g};if(g=f[6]){if(g.length&&"/"===g.substr(g.length-1,1))n=p.parentNode,k===p.namespaces&&(k=o.pop()),g=g.substr(0,g.length-1);for(var s,q=/((([\w\-]+):)?([\w\-]+))\s*=\s*('([^']*)'|"([^"]*)")/g;s=q.exec(g);){h=s[3]||"";var r=s[s[6]?6:7];if(s[1].indexOf("xmlns")){if(!p.attributes)p.attributes=[];s={nodeType:2,prefix:h,nodeName:s[4],value:c(r)};
h=""===h?"":k[h];if("undefined"===typeof h)throw'Unrecognized namespace with prefix "'+j+'"';s.namespaceURI=h;p.attributes.push(s)}else l||b(),k[s[3]?s[4]:""]=r}q.lastIndex=0}j=f[4]||"";p.prefix=j;h=k[j];if("undefined"===typeof h)throw'Unrecognized namespace with prefix "'+j+'"';p.namespaceURI=h}else if(g=f[10])if(f=f[9]||"",i.nodeName===g&&i.prefix===f)n=i.parentNode,k===i.namespaces&&(k=o.pop());else throw"Unclosed tag "+f+":"+g;else if(g=f[11])p={offset:f.index,parentNode:i,target:g,data:f[12],
nodeType:7};else if(f[13])p={offset:f.index,parentNode:i,nodeType:8,data:f[14]};else if((t=f[15])&&!/^\s+$/.test(t))p={offset:f.index,parentNode:i,nodeType:3,data:c(t)};if(p){if(!i.childNodes)i.childNodes=[];i.childNodes.push(p)}n&&(i=n)}return m}function H(a,b){var c=m(a,x,y,"complexType"),d=c.length,f,g;for(g=0;g<d;g++)if(f=c[g],o(f,"name")===b)return f;return null}function N(a){return"true"===a?!0:!1}function n(a){return parseInt(a,10)}function B(a){return parseFloat(a,10)}function I(a){return a}
function O(a){return Date.parse(a)}function P(a){return a}function J(a,b){var c=[],d=a.length,f,g;for(f=0;f<d;f++)g=a[f],c.push(b(r(g)));return c}function Q(a){var b;return(b=v[a])?b:I}function R(a){var b=r(a);if(a=z(a,K,L,"type"))if(a=v[a])return a(b);return b}function U(a){return"get"+(/^[A-Z]+[a-z]+[A-Za-z]*$/g.test(a)?a:a.charAt(0).toUpperCase()+a.substr(1).toLowerCase().replace(/_[a-z]/g,function(a){return a.charAt(1).toUpperCase()}))}var b,x="http://www.w3.org/2001/XMLSchema",y="xsd",K="http://www.w3.org/2001/XMLSchema-instance",
L="xsi",A;w.XMLHttpRequest?A=function(){return new w.XMLHttpRequest}:w.ActiveXObject?A=function(){return new w.ActiveXObject("MSXML2.XMLHTTP.3.0")}:"function"===typeof require?A=function(){var a;(a=function(){this.readyState=0;this.status=-1;this.statusText="Not sent";this.responseText=null}).prototype={changeStatus:function(a,b){this.statusText=this.status=a;this.readyState=b;u(this.onreadystatechange)&&this.onreadystatechange.call(this,this)},open:function(a,b,d,f,g){if(!0!==d)throw"Synchronous mode not supported in this environment.";
a=require("url").parse(b);if(a.host.length>a.hostname.length)a.host=a.hostname,delete a.hostname;if(!a.path&&a.pathname)a.path=a.pathname+(a.search||"");a.method="POST";a.headers={};if(f)a.headers.Authorization="Basic "+(new Buffer(f+":"+(g||""))).toString("base64");this.options=a;this.changeStatus(-1,1)},send:function(a){var b=this,d=b.options,f;d.headers["Content-Length"]=Buffer.byteLength(a);switch(d.protocol){case "http:":f=require("http");if(!d.port)d.port="80";break;case "https:":f=require("https");
if(!d.port)d.port="443";break;default:throw"Unsupported protocol "+d.protocol;}b.responseText="";d=f.request(d,function(a){a.setEncoding("utf8");b.changeStatus(-1,2);a.on("data",function(e){b.responseText+=e;b.changeStatus(a.statusCode,3)});a.on("error",function(){b.changeStatus(a.statusCode,4)});a.on("end",function(){b.changeStatus(a.statusCode,4)})});d.on("error",function(a){b.responseText=a;b.changeStatus(500,4)});a&&d.write(a);d.end()},setRequestHeader:function(a,b){this.options.headers[a]=b}};
return new a}:b.Exception._newError("ERROR_INSTANTIATING_XMLHTTPREQUEST","_ajax",null)._throw();var C=function(a,b){return(C=a.getElementsByTagName?function(a,b){return a.getElementsByTagName(b)}:function(a,b){var e=[];F(a,e,"*"===b?null:function(a){return 1===a.nodeType&&(""===a.namespaceURI?"":a.prefix+":")+a.nodeName===b});return e})(a,b)},m=function(a,b,c,d){var f;m=f=a.getElementsByTagNameNS?function(a,b,e,c){return a.getElementsByTagNameNS(b,c)}:a.getElementsByTagName?function(a,b,e,c){return a.getElementsByTagName((e?
e+":":"")+c)}:function(a,b,e,c){e=[];F(a,e,"*"===c?function(a){return 1===a.nodeType&&a.namespaceURI===b}:function(a){return 1===a.nodeType&&a.namespaceURI===b&&a.nodeName===c});return e};return f(a,b,c,d)},z=function(a,b,c,d){return(z=a.getAttributeNS?function(a,b,e,c){return a.getAttributeNS(b,c)}:a.getAttribute?function(a,b,e,c){return a.getAttribute((e?e+":":"")+c)}:function(a,b,e,c){a=a.attributes;if(!a)return null;for(var d=0,h=a.length;d<h;d++)if(e=a[d],e.namespaceURI===b&&e.nodeName===c)return e.value;
return null})(a,b,c,d)},o=function(a,b){return(o=a.getAttribute?function(a,b){return a.getAttribute(b)}:function(a,b){var e=a.attributes;if(!e)return null;for(var g,j=0,h=e.length;j<h;j++)if(g=e[j],g.nodeName===b)return g.value;return null})(a,b)};b=function(a){this.listeners={};this.listeners[b.EVENT_REQUEST]=[];this.listeners[b.EVENT_SUCCESS]=[];this.listeners[b.EVENT_ERROR]=[];this.listeners[b.EVENT_DISCOVER]=[];this.listeners[b.EVENT_DISCOVER_SUCCESS]=[];this.listeners[b.EVENT_DISCOVER_ERROR]=
[];this.listeners[b.EVENT_EXECUTE]=[];this.listeners[b.EVENT_EXECUTE_SUCCESS]=[];this.listeners[b.EVENT_EXECUTE_ERROR]=[];this.options=h(h({},b.defaultOptions,!0),a,!0);(a=this.options.listeners)&&this.addListener(a);return this};b.defaultOptions={requestTimeout:3E4,async:!1,addFieldGetters:!0,forceResponseXMLEmulation:!1};b.METHOD_DISCOVER="Discover";b.METHOD_EXECUTE="Execute";b.DISCOVER_DATASOURCES="DISCOVER_DATASOURCES";b.DISCOVER_PROPERTIES="DISCOVER_PROPERTIES";b.DISCOVER_SCHEMA_ROWSETS="DISCOVER_SCHEMA_ROWSETS";
b.DISCOVER_ENUMERATORS="DISCOVER_ENUMERATORS";b.DISCOVER_KEYWORDS="DISCOVER_KEYWORDS";b.DISCOVER_LITERALS="DISCOVER_LITERALS";b.DBSCHEMA_CATALOGS="DBSCHEMA_CATALOGS";b.DBSCHEMA_COLUMNS="DBSCHEMA_COLUMNS";b.DBSCHEMA_PROVIDER_TYPES="DBSCHEMA_PROVIDER_TYPES";b.DBSCHEMA_SCHEMATA="DBSCHEMA_SCHEMATA";b.DBSCHEMA_TABLES="DBSCHEMA_TABLES";b.DBSCHEMA_TABLES_INFO="DBSCHEMA_TABLES_INFO";b.MDSCHEMA_ACTIONS="MDSCHEMA_ACTIONS";b.MDSCHEMA_CUBES="MDSCHEMA_CUBES";b.MDSCHEMA_DIMENSIONS="MDSCHEMA_DIMENSIONS";b.MDSCHEMA_FUNCTIONS=
"MDSCHEMA_FUNCTIONS";b.MDSCHEMA_HIERARCHIES="MDSCHEMA_HIERARCHIES";b.MDSCHEMA_LEVELS="MDSCHEMA_LEVELS";b.MDSCHEMA_MEASURES="MDSCHEMA_MEASURES";b.MDSCHEMA_MEMBERS="MDSCHEMA_MEMBERS";b.MDSCHEMA_PROPERTIES="MDSCHEMA_PROPERTIES";b.MDSCHEMA_SETS="MDSCHEMA_SETS";b.EVENT_REQUEST="request";b.EVENT_SUCCESS="success";b.EVENT_ERROR="error";b.EVENT_EXECUTE="execute";b.EVENT_EXECUTE_SUCCESS="executesuccess";b.EVENT_EXECUTE_ERROR="executeerror";b.EVENT_DISCOVER="discover";b.EVENT_DISCOVER_SUCCESS="discoversuccess";
b.EVENT_DISCOVER_ERROR="discovererror";b.EVENT_GENERAL=[b.EVENT_REQUEST,b.EVENT_SUCCESS,b.EVENT_ERROR];b.EVENT_DISCOVER_ALL=[b.EVENT_DISCOVER,b.EVENT_DISCOVER_SUCCESS,b.EVENT_DISCOVER_ERROR];b.EVENT_EXECUTE_ALL=[b.EVENT_EXECUTE,b.EVENT_EXECUTE_SUCCESS,b.EVENT_EXECUTE_ERROR];b.EVENT_ALL=[].concat(b.EVENT_GENERAL,b.EVENT_DISCOVER_ALL,b.EVENT_EXECUTE_ALL);b.PROP_DATASOURCEINFO="DataSourceInfo";b.PROP_CATALOG="Catalog";b.PROP_CUBE="Cube";b.PROP_FORMAT="Format";b.PROP_FORMAT_TABULAR="Tabular";b.PROP_FORMAT_MULTIDIMENSIONAL=
"Multidimensional";b.PROP_AXISFORMAT="AxisFormat";b.PROP_AXISFORMAT_TUPLE="TupleFormat";b.PROP_AXISFORMAT_CLUSTER="ClusterFormat";b.PROP_AXISFORMAT_CUSTOM="CustomFormat";b.PROP_CONTENT="Content";b.PROP_CONTENT_DATA="Data";b.PROP_CONTENT_NONE="None";b.PROP_CONTENT_SCHEMA="Schema";b.PROP_CONTENT_SCHEMADATA="SchemaData";b.prototype={listeners:null,soapMessage:null,response:null,responseText:null,responseXML:null,getResponseXML:function(){return D(this.responseXML)?this.responseXML:this.responseXML=T(this.responseText)},
setOptions:function(a){h(this.options,a,!0)},addListener:function(){var a=arguments.length,e;switch(a){case 0:b.Exception._newError("NO_EVENTS_SPECIFIED","Xmla.addListener",null)._throw();case 1:var c=arguments[0];if(D(c)){var d;if(q(c))this._addListeners(c);else if(d=c.events||c.event){"string"===typeof d&&(d="all"===d?b.EVENT_ALL:d.split(","));q(d)||b.Exception._newError("WRONG_EVENTS_FORMAT","Xmla.addListener",c)._throw();a=d.length;for(e=0;e<a;e++)this._addListener(d[e],c)}else for(d in a=c.scope,
i(a)?a=null:delete c.scope,c){e=c[d];if(i(e.scope))e.scope=a;this._addListener(d,e)}}else b.Exception._newError("WRONG_EVENTS_FORMAT","Xmla.addListener",c)._throw();break;case 2:case 3:c=arguments[0];a=arguments[2];e=arguments[1];"string"===typeof c&&(u(e)||D(e))?this._addListener(c,e,a):(c=[c,e],a&&c.push(a),this.addListener(c));break;default:this._addListeners(arguments)}},_addListeners:function(a){var b,c=a.length;for(b=0;b<c;b++)this.addListener(a[b])},_addListener:function(a,e,c){var d=this.listeners[a];
d||b.Exception._newError("UNKNOWN_EVENT","Xmla.addListener",{event:a,handler:e,scope:c})._throw();c||(c=null);switch(typeof e){case "function":d.push({handler:e,scope:c});break;case "object":var f=e.handler||e.handlers;if(e.scope)c=e.scope;if(u(f))d.push({handler:f,scope:c});else if(q(f)){d=f.length;for(e=0;e<d;e++)this._addListener(a,f[e],c)}}},_fireEvent:function(a,e,c){var d=this.listeners[a];d||b.Exception._newError("UNKNOWN_EVENT","Xmla._fireEvent",a)._throw();var f=d.length,g=!0;if(f){var j,
h;for(h=0;h<f;h++)if(j=d[h],j=j.handler.call(j.scope,a,e,this),c&&!1===j){g=!1;break}}else a===b.EVENT_ERROR&&!u(e.error)&&!u(e.callback)&&e.exception._throw();return g},getXmlaSoapMessage:function(a){var e=a.method,c='<?xml version="1.0" encoding="UTF-8"?>\n<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">\n <SOAP-ENV:Body>\n  <'+e+' xmlns="urn:schemas-microsoft-com:xml-analysis" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">';
switch(e){case b.METHOD_DISCOVER:a.requestType||b.Exception._newError("MISSING_REQUEST_TYPE","Xmla._getXmlaSoapMessage",a)._throw();c+="\n   <RequestType>"+a.requestType+"</RequestType>"+G("Restrictions","RestrictionList",a.restrictions,"   ")+G("Properties","PropertyList",a.properties,"   ");break;case b.METHOD_EXECUTE:a.statement||b.Exception._newError("MISSING_REQUEST_TYPE","Xmla._getXmlaSoapMessage",a)._throw(),c+="\n   <Command>\n    <Statement>"+E(a.statement)+"</Statement>\n   </Command>"+
G("Properties","PropertyList",a.properties,"   ")}return c+("\n  </"+e+">\n </SOAP-ENV:Body>\n</SOAP-ENV:Envelope>")},request:function(a){var e,c=this;this.responseXML=this.responseText=this.response=null;a=h(a,this.options,!1);a.url||(e=b.Exception._newError("MISSING_URL","Xmla.request",a),e._throw());a.properties=h(a.properties,this.options.properties,!1);a.restrictions=h(a.restrictions,this.options.restrictions,!1);this.soapMessage=e=this.getXmlaSoapMessage(a);e={async:a.async,timeout:a.requestTimeout,
data:e,error:function(b){a.exception=b;c._requestError(a,b)},complete:function(b){a.xhr=b;c._requestSuccess(a)},url:a.url};if(a.username)e.username=a.username;if(a.password)e.password=a.password;if(a.headers)e.headers=a.headers;this._fireEvent(b.EVENT_REQUEST,a,!0)&&(a.method==b.METHOD_DISCOVER&&this._fireEvent(b.EVENT_DISCOVER,a)||a.method==b.METHOD_EXECUTE&&this._fireEvent(b.EVENT_EXECUTE,a))&&S(e);return this.response},_requestError:function(a,e){a.error&&a.error.call(a.scope?a.scope:null,this,
a,e);a.callback&&a.callback.call(a.scope?a.scope:null,b.EVENT_ERROR,this,a,e);this._fireEvent(b.EVENT_ERROR,a)},_requestSuccess:function(a){var e=a.xhr,c;if(!0!==a.forceResponseXMLEmulation)this.responseXML=e.responseXML;this.responseText=e.responseText;e=a.method;try{var d=this.getResponseXML(),f=m(d,"http://schemas.xmlsoap.org/soap/envelope/","SOAP-ENV","Fault");if(f.length)f=f[0],a.exception=new b.Exception(b.Exception.TYPE_ERROR,C(f,"faultcode")[0].childNodes[0].data,C(f,"faultstring")[0].childNodes[0].data,
null,"_requestSuccess",a);else{switch(e){case b.METHOD_DISCOVER:a.rowset=c=new b.Rowset(d,a.requestType,this);break;case b.METHOD_EXECUTE:var g=f=null;switch(a.properties[b.PROP_FORMAT]){case b.PROP_FORMAT_TABULAR:c=f=new b.Rowset(d,null,this);break;case b.PROP_FORMAT_MULTIDIMENSIONAL:c=g=new b.Dataset(d)}a.resultset=f;a.dataset=g}this.response=c}}catch(j){a.exception=j}if(a.exception){switch(e){case b.METHOD_DISCOVER:this._fireEvent(b.EVENT_DISCOVER_ERROR,a);break;case b.METHOD_EXECUTE:this._fireEvent(b.EVENT_EXECUTE_ERROR,
a)}a.error&&a.error.call(a.scope?a.scope:null,this,a,a.exception);a.callback&&a.callback.call(a.scope?a.scope:null,b.EVENT_ERROR,this,a,a.exception);this._fireEvent(b.EVENT_ERROR,a)}else{switch(e){case b.METHOD_DISCOVER:this._fireEvent(b.EVENT_DISCOVER_SUCCESS,a);break;case b.METHOD_EXECUTE:this._fireEvent(b.EVENT_EXECUTE_SUCCESS,a)}a.success&&a.success.call(a.scope?a.scope:null,this,a,c);a.callback&&a.callback.call(a.scope?a.scope:null,b.EVENT_SUCCESS,this,a,c);this._fireEvent(b.EVENT_SUCCESS,a)}},
execute:function(a){var e=a.properties;if(!e)e={},a.properties=e;h(e,this.options.properties,!1);if(!e[b.PROP_CONTENT])e[b.PROP_CONTENT]=b.PROP_CONTENT_SCHEMADATA;if(!e[b.PROP_FORMAT])a.properties[b.PROP_FORMAT]=b.PROP_FORMAT_MULTIDIMENSIONAL;return this.request(h(a,{method:b.METHOD_EXECUTE},!0))},executeTabular:function(a){if(!a.properties)a.properties={};a.properties[b.PROP_FORMAT]=b.PROP_FORMAT_TABULAR;return this.execute(a)},executeMultiDimensional:function(a){if(!a.properties)a.properties={};
a.properties[b.PROP_FORMAT]=b.PROP_FORMAT_MULTIDIMENSIONAL;return this.execute(a)},discover:function(a){a=h(a,{method:b.METHOD_DISCOVER},!0);if(!a.requestType)a.requestType=this.options.requestType;return this.request(a)},discoverDataSources:function(a){return this.discover(h(a,{requestType:b.DISCOVER_DATASOURCES},!0))},discoverProperties:function(a){return this.discover(h(a,{requestType:b.DISCOVER_PROPERTIES},!0))},discoverSchemaRowsets:function(a){return this.discover(h(a,{requestType:b.DISCOVER_SCHEMA_ROWSETS},
!0))},discoverEnumerators:function(a){return this.discover(h(a,{requestType:b.DISCOVER_ENUMERATORS},!0))},discoverKeywords:function(a){return this.discover(h(a,{requestType:b.DISCOVER_KEYWORDS},!0))},discoverLiterals:function(a){return this.discover(h(a,{requestType:b.DISCOVER_LITERALS},!0))},discoverDBCatalogs:function(a){return this.discover(h(a,{requestType:b.DBSCHEMA_CATALOGS},!0))},discoverDBColumns:function(a){return this.discover(h(a,{requestType:b.DBSCHEMA_COLUMNS},!0))},discoverDBProviderTypes:function(a){return this.discover(h(a,
{requestType:b.DBSCHEMA_PROVIDER_TYPES},!0))},discoverDBSchemata:function(a){return this.discover(h(a,{requestType:b.DBSCHEMA_SCHEMATA},!0))},discoverDBTables:function(a){return this.discover(h(a,{requestType:b.DBSCHEMA_TABLES},!0))},discoverDBTablesInfo:function(a){return this.discover(h(a,{requestType:b.DBSCHEMA_TABLES_INFO},!0))},discoverMDActions:function(a){return this.discover(h(a,{requestType:b.MDSCHEMA_ACTIONS},!0))},discoverMDCubes:function(a){return this.discover(h(a,{requestType:b.MDSCHEMA_CUBES},
!0))},discoverMDDimensions:function(a){return this.discover(h(a,{requestType:b.MDSCHEMA_DIMENSIONS},!0))},discoverMDFunctions:function(a){return this.discover(h(a,{requestType:b.MDSCHEMA_FUNCTIONS},!0))},discoverMDHierarchies:function(a){return this.discover(h(a,{requestType:b.MDSCHEMA_HIERARCHIES},!0))},discoverMDLevels:function(a){return this.discover(h(a,{requestType:b.MDSCHEMA_LEVELS},!0))},discoverMDMeasures:function(a){return this.discover(h(a,{requestType:b.MDSCHEMA_MEASURES},!0))},discoverMDMembers:function(a){return this.discover(h(a,
{requestType:b.MDSCHEMA_MEMBERS},!0))},discoverMDProperties:function(a){return this.discover(h(a,{requestType:b.MDSCHEMA_PROPERTIES},!0))},discoverMDSets:function(a){return this.discover(h(a,{requestType:b.MDSCHEMA_SETS},!0))}};b.Rowset=function(a,b,c){this._node=a;this._type=b;this._xmla=c;this._initData();return this};b.Rowset.MD_DIMTYPE_UNKNOWN=0;b.Rowset.MD_DIMTYPE_TIME=1;b.Rowset.MD_DIMTYPE_MEASURE=2;b.Rowset.MD_DIMTYPE_OTHER=3;b.Rowset.MD_DIMTYPE_QUANTITATIVE=5;b.Rowset.MD_DIMTYPE_ACCOUNTS=
6;b.Rowset.MD_DIMTYPE_CUSTOMERS=7;b.Rowset.MD_DIMTYPE_PRODUCTS=8;b.Rowset.MD_DIMTYPE_SCENARIO=9;b.Rowset.MD_DIMTYPE_UTILIY=10;b.Rowset.MD_DIMTYPE_CURRENCY=11;b.Rowset.MD_DIMTYPE_RATES=12;b.Rowset.MD_DIMTYPE_CHANNEL=13;b.Rowset.MD_DIMTYPE_PROMOTION=14;b.Rowset.MD_DIMTYPE_ORGANIZATION=15;b.Rowset.MD_DIMTYPE_BILL_OF_MATERIALS=16;b.Rowset.MD_DIMTYPE_GEOGRAPHY=17;b.Rowset.MD_STRUCTURE_FULLYBALANCED=0;b.Rowset.MD_STRUCTURE_RAGGEDBALANCED=1;b.Rowset.MD_STRUCTURE_UNBALANCED=2;b.Rowset.MD_STRUCTURE_NETWORK=
3;b.Rowset.MD_USER_DEFINED=1;b.Rowset.MD_SYSTEM_ENABLED=2;b.Rowset.MD_SYSTEM_INTERNAL=4;b.Rowset.MDMEMBER_TYPE_REGULAR=1;b.Rowset.MDMEMBER_TYPE_ALL=2;b.Rowset.MDMEMBER_TYPE_FORMULA=3;b.Rowset.MDMEMBER_TYPE_MEASURE=4;b.Rowset.MDMEMBER_TYPE_UNKNOWN=0;b.Rowset.KEYS={};b.Rowset.KEYS[b.DBSCHEMA_CATALOGS]=["CATALOG_NAME"];b.Rowset.KEYS[b.DBSCHEMA_COLUMNS]=["TABLE_CATALOG","TABLE_SCHEMA","TABLE_NAME","COLUMN_NAME"];b.Rowset.KEYS[b.DBSCHEMA_PROVIDER_TYPES]=["TYPE_NAME"];b.Rowset.KEYS[b.DBSCHEMA_SCHEMATA]=
["CATALOG_NAME","SCHEMA_NAME"];b.Rowset.KEYS[b.DBSCHEMA_TABLES]=["TABLE_CATALOG","TABLE_SCHEMA","TABLE_NAME"];b.Rowset.KEYS[b.DBSCHEMA_TABLES_INFO]=["TABLE_CATALOG","TABLE_SCHEMA","TABLE_NAME"];b.Rowset.KEYS[b.DISCOVER_DATASOURCES]=["DataSourceName"];b.Rowset.KEYS[b.DISCOVER_ENUMERATORS]=["EnumName","ElementName"];b.Rowset.KEYS[b.DISCOVER_KEYWORDS]=["Keyword"];b.Rowset.KEYS[b.DISCOVER_LITERALS]=["LiteralName"];b.Rowset.KEYS[b.DISCOVER_PROPERTIES]=["PropertyName"];b.Rowset.KEYS[b.DISCOVER_SCHEMA_ROWSETS]=
["SchemaName"];b.Rowset.KEYS[b.MDSCHEMA_ACTIONS]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","ACTION_NAME"];b.Rowset.KEYS[b.MDSCHEMA_CUBES]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME"];b.Rowset.KEYS[b.MDSCHEMA_DIMENSIONS]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","DIMENSION_UNIQUE_NAME"];b.Rowset.KEYS[b.MDSCHEMA_FUNCTIONS]=["FUNCTION_NAME","PARAMETER_LIST"];b.Rowset.KEYS[b.MDSCHEMA_HIERARCHIES]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","DIMENSION_UNIQUE_NAME","HIERARCHY_UNIQUE_NAME"];b.Rowset.KEYS[b.MDSCHEMA_LEVELS]=
"CATALOG_NAME,SCHEMA_NAME,CUBE_NAME,DIMENSION_UNIQUE_NAME,HIERARCHY_UNIQUE_NAME,LEVEL_UNIQUE_NAME".split(",");b.Rowset.KEYS[b.MDSCHEMA_MEASURES]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","MEASURE_NAME"];b.Rowset.KEYS[b.MDSCHEMA_MEMBERS]="CATALOG_NAME,SCHEMA_NAME,CUBE_NAME,DIMENSION_UNIQUE_NAME,HIERARCHY_UNIQUE_NAME,LEVEL_UNIQUE_NAME,MEMBER_UNIQUE_NAME".split(",");b.Rowset.KEYS[b.MDSCHEMA_PROPERTIES]="CATALOG_NAME,SCHEMA_NAME,CUBE_NAME,DIMENSION_UNIQUE_NAME,HIERARCHY_UNIQUE_NAME,LEVEL_UNIQUE_NAME,MEMBER_UNIQUE_NAME,PROPERTY_NAME".split(",");
b.Rowset.KEYS[b.MDSCHEMA_SETS]=["CATALOG_NAME","SCHEMA_NAME","CUBE_NAME","SET_NAME"];N.jsType="boolean";n.jsType="number";B.jsType="number";I.jsType="string";O.jsType="object";P.jsType="object";J.jsType="object";var v={"xsd:boolean":N,"xsd:decimal":B,"xsd:double":B,"xsd:float":B,"xsd:int":n,"xsd:integer":n,"xsd:nonPositiveInteger":n,"xsd:negativeInteger":n,"xsd:nonNegativeInteger":n,"xsd:positiveInteger":n,"xsd:short":n,"xsd:byte":n,"xsd:long":n,"xsd:unsignedLong":n,"xsd:unsignedInt":n,"xsd:unsignedShort":n,
"xsd:unsignedByte":n,"xsd:string":I,"xsd:dateTime":O,Restrictions:P};b.Rowset.prototype={_node:null,_type:null,_row:null,_rows:null,numRows:null,fieldOrder:null,fields:null,_fieldCount:null,_initData:function(){this.numRows=(this._rows=m(this._node,"urn:schemas-microsoft-com:xml-analysis:rowset",null,"row"))?this._rows.length:0;this.reset();this.fieldOrder=[];this.fields={};this._fieldCount=0;var a=H(this._node,"row");if(a){var e=(a=m(a,x,y,"sequence")[0].childNodes)?a.length:0,c,d,f,g,j,h,k,l=this._xmla.options.addFieldGetters,
i;for(i=0;i<e;i++)c=a[i],1===c.nodeType&&(d=z(c,"urn:schemas-microsoft-com:xml-sql","sql","field"),f=o(c,"name"),j=o(c,"type"),null===j&&this._row&&(g=C(this._row,f),g.length&&(j=z(g[0],K,L,"type"))),!j&&this._type==b.DISCOVER_SCHEMA_ROWSETS&&"Restrictions"===f&&(j="Restrictions"),g=(g=o(c,"minOccurs"))?parseInt(g,10):1,(c=o(c,"maxOccurs"))?"unbounded"===c?c=Infinity:g=parseInt(c,10):c=1,h=Q(j),k=this._createFieldGetter(f,h,g,c),l&&(this[U(f)]=k),this.fields[d]={name:f,label:d,index:this._fieldCount++,
type:j,jsType:h.jsType,minOccurs:g,maxOccurs:c,getter:k},this.fieldOrder.push(d))}else b.Exception._newError("ERROR_PARSING_RESPONSE","Xmla.Rowset",this._node)._throw()},_createFieldGetter:function(a,b,c,d){var f;1===d?1===c?f=function(){var c=m(this._row,"urn:schemas-microsoft-com:xml-analysis:rowset",null,a);return b(r(c[0]))}:0===c&&(f=function(){var c=m(this._row,"urn:schemas-microsoft-com:xml-analysis:rowset",null,a);return c.length?b(r(c[0])):null}):1===c?f=function(){var c=m(this._row,"urn:schemas-microsoft-com:xml-analysis:rowset",
null,a);return J(c,b)}:0===c&&(f=function(){var c=m(this._row,"urn:schemas-microsoft-com:xml-analysis:rowset",null,a);return c.length?J(c,b):null});return f},getType:function(){return this._type},getFields:function(){var a=[],b,c=this._fieldCount,d=this.fieldOrder;for(b=0;b<c;b++)a[b]=this.fieldDef(d[b]);return a},getFieldNames:function(){var a=[],b,c=this._fieldCount;for(b=0;b<c;b++)a[b]=this.fieldOrder[b];return a},hasMoreRows:function(){return this.numRows>this.rowIndex},nextRow:function(){this.rowIndex++;
this._row=this._rows[this.rowIndex];return this.rowIndex},next:function(){return this.nextRow()},eachRow:function(a,b,c){i(b)&&(b=this);var d=[null];i(c)||(q(c)||(c=[c]),d=d.concat(c));for(;this.hasMoreRows();){d[0]=this.readAsObject();if(!1===a.apply(b,d))return!1;this.nextRow()}return!0},currRow:function(){return this.rowIndex},rowCount:function(){return this.numRows},reset:function(){this.rowIndex=0;this._row=this.hasMoreRows()?this._rows[this.rowIndex]:null},fieldDef:function(a){var e=this.fields[a];
e||b.Exception._newError("INVALID_FIELD","Xmla.Rowset.fieldDef",a)._throw();return e},fieldIndex:function(a){return this.fieldDef(a).index},fieldName:function(a){var e=this.fieldOrder[a];e||b.Exception._newError("INVALID_FIELD","Xmla.Rowset.fieldDef",a)._throw();return e},fieldVal:function(a){"number"===typeof a&&(a=this.fieldName(a));return this.fieldDef(a).getter.call(this)},fieldCount:function(){return this._fieldCount},close:function(){this._rows=this._row=this._node=null},readAsArray:function(a){var b=
this.fields,c,d;a||(a=[]);for(c in b)b.hasOwnProperty(c)&&(d=b[c],a[d.index]=d.getter.call(this));return a},fetchAsArray:function(a){this.hasMoreRows()?(a=this.readAsArray(a),this.nextRow()):a=!1;return a},readAsObject:function(a){var b=this.fields,c,d;a||(a={});for(c in b)b.hasOwnProperty(c)&&(d=b[c],a[c]=d.getter.call(this));return a},fetchAsObject:function(a){this.hasMoreRows()?(a=this.readAsObject(a),this.nextRow()):a=!1;return a},fetchCustom:function(a,b){var c;this.hasMoreRows()?(c=a.call(this,
b),this.nextRow()):c=!1;return c},fetchAllAsArray:function(a){var b;for(a||(a=[]);b=this.fetchAsArray();)a.push(b);return a},fetchAllAsObject:function(a){var b;for(a||(a=[]);b=this.fetchAsObject();)a.push(b);return a},fetchAllCustom:function(a,b,c){var d;for(a||(a=[]);d=this.fetchCustom(b,c);)a.push(d);return a},mapAsObject:function(a,b,c){for(var d,f,g=b.length,j=g-1,h=a,a=0;a<g;a++)d=b[a],d=c[d],(f=h[d])?a===j?q(f)?f.push(c):h[d]=[f,c]:h=f:a===j?h[d]=c:h=h[d]={}},mapAllAsObject:function(a,b){b||
(b={});a||(a=this.getKey());for(var c;c=this.fetchAsObject();)this.mapAsObject(b,a,c);return b},getKey:function(){return this._type?b.Rowset.KEYS[this._type]:this.getFieldNames()}};b.Dataset=function(a){this._initDataset(a);return this};b.Dataset.AXIS_COLUMNS=0;b.Dataset.AXIS_ROWS=1;b.Dataset.AXIS_PAGES=2;b.Dataset.AXIS_SECTIONS=3;b.Dataset.AXIS_CHAPTERS=4;b.Dataset.AXIS_SLICER="SlicerAxis";b.Dataset.prototype={_root:null,_axes:null,_axesOrder:null,_numAxes:null,_slicer:null,_cellset:null,_initDataset:function(a){this._initRoot(a);
this.cubeName=r(m(this._root,"urn:schemas-microsoft-com:xml-analysis:mddataset","","CubeName")[0]);this._initAxes();this._initCells();var b,c,d,f;d="var ordinal = 0, a;\nif (arguments.length !== "+this._numAxes+') new Xmla.Exception._newError("ERROR_ILLEGAL_ARGUMENT", "cellOrdinalForTupleIndexes", this)._throw();';for(a=0,b=this._numAxes-1;0<=b;b--,a++){d+="\nif (typeof(a = arguments["+a+'])!=="number") new Xmla.Exception._newError("ERROR_ILLEGAL_ARGUMENT", "cellOrdinalForTupleIndexes", this)._throw();';
f=1;for(c=b-1;0<=c;c--)f*=this._axesOrder[c].tupleCount();d+="\nordinal += a ";b&&(d+="* "+f+";")}this._cellset.cellOrdinalForTupleIndexes=this.cellOrdinalForTupleIndexes=new Function(d+"\nreturn ordinal;")},_initRoot:function(a){var e=m(a,"urn:schemas-microsoft-com:xml-analysis:mddataset","","root");e.length?this._root=e[0]:b.Exception._newError("ERROR_PARSING_RESPONSE","Xmla.Dataset._initData",a)._throw()},_initAxes:function(){var a,e,c,d,f,g={};this._axes={};this._axesOrder=[];d=m(this._root,"urn:schemas-microsoft-com:xml-analysis:mddataset",
"","AxisInfo");f=d.length;for(a=0;a<f;a++)e=d[a],c=o(e,"name"),g[c]=e;d=m(this._root,"urn:schemas-microsoft-com:xml-analysis:mddataset","","Axis");f=d.length;for(a=0;a<f;a++)e=d[a],c=o(e,"name"),e=new b.Dataset.Axis(this,g[c],e,c,a),c===b.Dataset.AXIS_SLICER?this._slicer=e:(this._axes[c]=e,this._axesOrder.push(e));this._numAxes=this._axesOrder.length},_initCells:function(){this._cellset=new b.Dataset.Cellset(this)},axisCount:function(){return this._numAxes},_getAxis:function(a){var e;switch(typeof a){case "number":e=
this._axesOrder[a];break;case "string":e=void 0===b.Dataset.AXIS_SLICER?this._slicer:this._axes[void 0]}return e},getAxis:function(a){if(a===b.Dataset.AXIS_SLICER)return this._slicer;var e=this._getAxis(a);e||b.Exception._newError("INVALID_AXIS","Xmla.Dataset.getAxis",a)._throw();return e},hasAxis:function(a){a=this._getAxis(a);return!i(a)},getColumnAxis:function(){return this.getAxis(b.Dataset.AXIS_COLUMNS)},hasColumnAxis:function(){return this.hasAxis(b.Dataset.AXIS_COLUMNS)},getRowAxis:function(){return this.getAxis(b.Dataset.AXIS_ROWS)},
hasRowAxis:function(){return this.hasAxis(b.Dataset.AXIS_ROWS)},getPageAxis:function(){return this.getAxis(b.Dataset.AXIS_PAGES)},hasPageAxis:function(){return this.hasAxis(b.Dataset.AXIS_PAGES)},getSectionAxis:function(){return this.getAxis(b.Dataset.AXIS_SECTIONS)},hasSectionAxis:function(){return this.hasAxis(b.Dataset.AXIS_SECTIONS)},getChapterAxis:function(){return this.getAxis(b.Dataset.AXIS_CHAPTERS)},hasChapterAxis:function(){return this.hasAxis(b.Dataset.AXIS_CHAPTERS)},getSlicerAxis:function(){return this._slicer},
hasSlicerAxis:function(){return null!==this._slicer},getCellset:function(){return this._cellset},cellOrdinalForTupleIndexes:function(){throw"Not implemented";},fetchAsObject:function(){var a=function(a){a.getHierarchies();var b=[],c,e=a.numHierarchies;for(c=0;c<e;c++)b.push(a.hierarchy(c));return b},b=[],c;c=[];var d=[],f,g,h;f=1;var i=0;for(g=0,h=this.axisCount();g<h;g++)c=this.getAxis(g),f*=c.tupleCount(),b.push({positions:c.fetchAllAsObject(),hierarchies:a(c)});this.hasSlicerAxis?(c=this.getSlicerAxis(),
a={positions:c.fetchAllAsObject(),hierarchies:a(c)}):a={positions:{},hierarchies:[]};c=this.getCellset();for(g=0,h=f;g<h;g++)f=c.readCell(),i==f.ordinal?(d.push(f),c.nextCell()):d.push({Value:null,FmtValue:null,FormatString:null,ordinal:i}),i++;c.reset();return{cubeName:this.cubeName,axes:b,filterAxis:a,cells:d}},reset:function(){this._cellset&&this._cellset.reset();if(this._axes){var a,b;for(a=0,b=this.axisCount();a<b;a++)this.getAxis(a).reset()}},close:function(){this._slicer&&this._slicer.close();
var a,b=this._numAxes;for(a=0;a<b;a++)this.getAxis(a).close();this._cellset.close();this._slicer=this._numAxes=this._axesOrder=this._axes=this._root=this._cellset=null}};b.Dataset.Axis=function(a,b,c,d,f){this._dataset=a;this._initAxis(b,c);this.name=d;this.id=f;return this};b.Dataset.Axis.MEMBER_UNIQUE_NAME="UName";b.Dataset.Axis.MEMBER_CAPTION="Caption";b.Dataset.Axis.MEMBER_LEVEL_NAME="LName";b.Dataset.Axis.MEMBER_LEVEL_NUMBER="LNum";b.Dataset.Axis.MEMBER_DISPLAY_INFO="DisplayInfo";b.Dataset.Axis.MDDISPINFO_CHILDREN_CARDINALITY=
65535;b.Dataset.Axis.MDDISPINFO_DRILLED_DOWN=65536;b.Dataset.Axis.MDDISPINFO_SAME_PARENT_AS_PREV=131072;b.Dataset.Axis.prototype={_dataset:null,_tuples:null,_members:null,_memberProperties:null,numTuples:null,numHierarchies:null,_tupleIndex:null,_hierarchyIndex:null,_hierarchyOrder:null,_hierarchyDefs:null,_hierarchyIndexes:null,_initHierarchies:function(a){var a=m(a,"urn:schemas-microsoft-com:xml-analysis:mddataset","","HierarchyInfo"),b=a.length,c,d,f,g,h,i,k,l,n=this._memberProperties;this._hierarchyDefs=
{};this._hierarchyOrder=[];this._hierarchyIndexes={};this.numHierarchies=b;for(c=0;c<b;c++){d=a[c];f=o(d,"name");this._hierarchyOrder[c]=f;this._hierarchyIndexes[f]=c;g={index:c,name:f};i=m(d,"urn:schemas-microsoft-com:xml-analysis:mddataset","","*");h=i.length;for(d=0;d<h;d++)k=i[d],l=k.nodeName,g[l]=null,n[l]||(k=o(k,"type"),n[l]={converter:v[k],name:M(l)});this._hierarchyDefs[f]=g}},_initMembers:function(){var a=this._dataset._root,e,c,d,f,g=this._memberProperties={};(e=H(a,"MemberType"))||b.Exception._newError("ERROR_PARSING_RESPONSE",
"Xmla.DataSet.Axis",a)._throw();e=m(e,x,y,"sequence")[0];a=m(e,x,y,"element");e=a.length;for(f=0;f<e;f++)c=a[f],d=o(c,"type"),c=o(c,"name"),g[c]={converter:v[d],name:M(c)}},_initAxis:function(a,b){this.name=o(b,"name");this._initMembers();this._initHierarchies(a);this._tuples=m(b,"urn:schemas-microsoft-com:xml-analysis:mddataset","","Tuple");this.numTuples=this._tuples.length;this.reset()},close:function(){this.numTuples=-1;this._members=this._hierarchyIndexes=this._hierarchyOrder=this._hierarchyDefs=
this._tuples=null},_getMembers:function(){return!this.hasMoreTuples()?null:m(this._tuples[this._tupleIndex],"urn:schemas-microsoft-com:xml-analysis:mddataset","","Member")},reset:function(){this._tupleIndex=this._hierarchyIndex=0;this._members=this._getMembers()},hasMoreHierarchies:function(){return this.numHierarchies>this._hierarchyIndex},nextHierarchy:function(){return this._hierarchyIndex++},eachHierarchy:function(a,b,c){var d=[null];b||(b=this);c&&(q(c)||(c=[c]),d=d.concat(c));for(;this.hasMoreHierarchies();){d[0]=
this._hierarchyDefs[this._hierarchyOrder[this._hierarchyIndex]];if(!1===a.apply(b,d))return!1;this.nextHierarchy()}this._hierarchyIndex=0;return!0},hasMoreTuples:function(){return this.numTuples>this._tupleIndex},nextTuple:function(){this._tupleIndex++;this._members=this._getMembers();return this._tupleIndex},tupleCount:function(){return this.numTuples},tupleIndex:function(){return this._tupleIndex},getTuple:function(){var a,b=this.numHierarchies,c={},d=[],f={index:this._tupleIndex,hierarchies:c,
members:d};for(a=0;a<b;a++)d.push(c[this._hierarchyOrder[a]]=this._member(a));return f},eachTuple:function(a,b,c){var d=[null];b||(b=this);for(c&&(q(c)?d.concat(c):d.push(c));this.hasMoreTuples();){d[0]=this.getTuple();if(!1===a.apply(b,d))return!1;this.nextTuple()}this._tupleIndex=0;this._members=this._getMembers();return!0},getHierarchies:function(){return this._hierarchyDefs},getHierarchyNames:function(){var a=[],b,c=this.numHierarchies;for(b=0;b<c;b++)a[b]=this._hierarchyOrder[b];return a},hierarchyCount:function(){return this.numHierarchies},
hierarchyIndex:function(a){if(i(a))return this._hierarchyIndex;var e=this._hierarchyIndexes[a];i(e)&&b.Exception._newError("INVALID_HIERARCHY","Xmla.Dataset.Axis.hierarchyDef",a)._throw();return e},hierarchyName:function(a){if(i(a))a=this._hierarchyIndex;(a!==parseInt(a,10)||a>=this.numHierarchies)&&b.Exception._newError("INVALID_HIERARCHY","Xmla.Dataset.Axis.hierarchyDef",a)._throw();return this._hierarchyOrder[a]},hierarchy:function(a){i(a);var e;"number"===typeof a&&((a!==parseInt(a,10)||a>=this.numHierarchies)&&
b.Exception._newError("INVALID_HIERARCHY","Xmla.Dataset.Axis.hierarchyDef",a)._throw(),a=this.hierarchyName(a));e=this._hierarchyDefs[a];i(e)&&b.Exception._newError("INVALID_HIERARCHY","Xmla.Dataset.Axis.hierarchyDef",a)._throw();return e},member:function(a){if(i(a))e=this._hierarchyIndex;var e;switch(typeof a){case "string":e=this.hierarchyIndex(a);break;case "number":(a!==parseInt(a,10)||a>=this.numHierarchies)&&b.Exception._newError("INVALID_HIERARCHY","Xmla.Dataset.Axis.hierarchyDef",a)._throw(),
e=a}return this._member(e)},_member:function(a){for(var b=this._members[a].childNodes,c=b.length,d=this.hierarchyName(a),f,d={index:a,hierarchy:d},g,h=this._memberProperties,a=0;a<c;a++)if(g=b[a],1===g.nodeType&&(f=h[g.nodeName]))d[f.name]=f.converter(r(g));return d},hasMemberProperty:function(a){return!i(this._memberProperties[a])},readAsArray:function(a){a||(a=[]);var b,c=this.numHierarchies;for(b=0;b<c;b++)a[b]=this._member(b);return a},readAsObject:function(a){a||(a={});var b,c=this.numHierarchies;
for(b=0;b<c;b++)a[this._hierarchyOrder[b]]=this._member(b);return a},fetchAsArray:function(a){this.hasMoreTuples()?(a=this.readAsArray(a),this.nextTuple()):a=!1;return a},fetchAsObject:function(a){this.hasMoreTuples(a)?(a=this.readAsObject(),this.nextTuple()):a=!1;return a},fetchAllAsArray:function(a){var b;for(a||(a=[]);b=this.fetchAsArray();)a.push(b);this.reset();return a},fetchAllAsObject:function(a){var b;for(a||(a=[]);b=this.fetchAsObject();)a.push(b);this.reset();return a}};b.Dataset.Cellset=
function(a){this._dataset=a;this._initCellset();return this};b.Dataset.Cellset.prototype={_dataset:null,_cellNodes:null,_cellCount:null,_cellNode:null,_cellProperties:null,_idx:null,_cellOrd:null,_initCellset:function(){var a=this._dataset._root,e,c,d,f,g,h,i,k,l;(e=H(a,"CellData"))||b.Exception._newError("ERROR_PARSING_RESPONSE","Xmla.Dataset.Cellset",a)._throw();e=m(e,x,y,"element");c=e.length;f=m(a,"urn:schemas-microsoft-com:xml-analysis:mddataset","","CellInfo");(!f||0===f.length)&&b.Exception._newError("ERROR_PARSING_RESPONSE",
"Xmla.Rowset",a)._throw();f=m(f[0],"urn:schemas-microsoft-com:xml-analysis:mddataset","","*");this._cellProperties={};i=f.length;for(k=0;k<i;k++){g=f[k];h=g.nodeName;for(l=0;l<c;l++)if(d=e[l],o(d,"name")===h){d=o(d,"type");this._cellProperties[h]=v[d];this["cell"+h]=new Function('return this.cellProperty("'+h+'")');break}this._cellProperties[h]||((d=o(g,"type"))||(d="Value"===h?"xs:decimal":"xs:string"),this._cellProperties[h]=v[d],this["cell"+h]=new Function('return this.cellProperty("'+h+'")'))}this._cellNodes=
m(a,"urn:schemas-microsoft-com:xml-analysis:mddataset","","Cell");this._cellCount=this._cellNodes.length;this.reset()},_getCellNode:function(a){if(!i(a))this._idx=a;this._cellNode=this._cellNodes[this._idx];this._cellOrd=this._getCellOrdinal(this._cellNode)},_getCellOrdinal:function(a){return parseInt(o(a,"CellOrdinal"),10)},cellCount:function(){return this._cellNodes.length},reset:function(a){this._idx=a?a:0;this._getCellNode()},hasMoreCells:function(){return this._idx<this._cellCount},nextCell:function(){this._idx+=
1;if(this.hasMoreCells())return this._getCellNode(),this._cellOrd;this._idx=0;return-1},curr:function(){return this._idx},hasCellProperty:function(a){return!i(this._cellProperties[a])},cellProperty:function(a){var b,c;c=m(this._cellNode,"urn:schemas-microsoft-com:xml-analysis:mddataset","",a)[0];b=R(c);a=this._cellProperties[a];a||(c=z(c,K,L,"type"),a=Q(c));return a(b)},cellOrdinal:function(){return this._cellOrd},_readCell:function(a,b){var c,d,f;for(c in this._cellProperties)if(d=m(a,"urn:schemas-microsoft-com:xml-analysis:mddataset",
"",c)[0])f=this._cellProperties[c],b[c]=f?f(r(d)):"Value"===c?R(d):r(d);b.ordinal=this._getCellOrdinal(a);return b},readCell:function(a){a||(a={});return this._readCell(this._cellNode,a)},eachCell:function(a,b,c){var d=[null];b||(b=this);c&&(q(c)||(c=[c]),d=d.concat(c));for(;this.hasMoreCells();)if(this.nextCell(),d[0]=this.readCell(),!1===a.apply(b,d))return!1;this._idx=0;return!0},getByIndex:function(a,b){this._getCellNode(a);return this.readCell(b)},getByOrdinal:function(a,b){var c,d;d=this.cellCount()-
1;for(d=a>d?d:a;;){c=this._cellNodes[d];c=this._getCellOrdinal(c);if(c===a)return this.getByIndex(d,b);if(c>a)d--;else return null}},indexForOrdinal:function(a){for(var b=a,c;;){(c=this._cellNodes[b])||(c=this._cellNodes[this._cellNodes.length-1]);c=this._getCellOrdinal(c);if(c===a)return b;if(c>a)b--;else return-1}return null},fetchRangeAsArray:function(a,b){var c=[],d=this._cellNodes,a=this.indexForOrdinal(a);if(-1===a)return c;b=this.indexForOrdinal(b);-1===b&&(b=d.length-1);for(var b=Math.min(b,
d.length-1),f=a;f<=b;f++)c.push(this._readCell(d[f],{}));return c},cellOrdinalForTupleIndexes:function(){throw"Not implemented";},getByTupleIndexes:function(){return this.getByOrdinal(this.cellOrdinalForTupleIndexes.apply(this,arguments))},close:function(){this._cellNode=this._cellNodes=this._dataset=null}};b.Exception=function(a,b,c,d,f,g,h){this.type=a;this.code=b;this.message=c;this.source=f;this.helpfile=d;this.data=g;this.args=h;return this};b.Exception.TYPE_WARNING="warning";b.Exception.TYPE_ERROR=
"error";b.Exception.MISSING_REQUEST_TYPE_CDE=-1;b.Exception.MISSING_REQUEST_TYPE_MSG="Missing_Request_Type";b.Exception.MISSING_REQUEST_TYPE_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.MISSING_REQUEST_TYPE_CDE+"_"+b.Exception.MISSING_REQUEST_TYPE_MSG;b.Exception.MISSING_STATEMENT_CDE=-2;b.Exception.MISSING_STATEMENT_MSG="Missing_Statement";b.Exception.MISSING_STATEMENT_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.MISSING_STATEMENT_CDE+"_"+b.Exception.MISSING_STATEMENT_MSG;
b.Exception.MISSING_URL_CDE=-3;b.Exception.MISSING_URL_MSG="Missing_URL";b.Exception.MISSING_URL_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.MISSING_URL_CDE+"_"+b.Exception.MISSING_URL_MSG;b.Exception.NO_EVENTS_SPECIFIED_CDE=-4;b.Exception.NO_EVENTS_SPECIFIED_MSG="No_Events_Specified";b.Exception.NO_EVENTS_SPECIFIED_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.NO_EVENTS_SPECIFIED_CDE+"_"+b.Exception.NO_EVENTS_SPECIFIED_MSG;b.Exception.WRONG_EVENTS_FORMAT_CDE=
-5;b.Exception.WRONG_EVENTS_FORMAT_MSG="Wrong_Events_Format";b.Exception.WRONG_EVENTS_FORMAT_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.NO_EVENTS_SPECIFIED_CDE+"_"+b.Exception.NO_EVENTS_SPECIFIED_MSG;b.Exception.UNKNOWN_EVENT_CDE=-6;b.Exception.UNKNOWN_EVENT_MSG="Unknown_Event";b.Exception.UNKNOWN_EVENT_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.UNKNOWN_EVENT_CDE+"_"+b.Exception.UNKNOWN_EVENT_MSG;b.Exception.INVALID_EVENT_HANDLER_CDE=-7;b.Exception.INVALID_EVENT_HANDLER_MSG=
"Invalid_Events_Handler";b.Exception.INVALID_EVENT_HANDLER_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.INVALID_EVENT_HANDLER_CDE+"_"+b.Exception.INVALID_EVENT_HANDLER_MSG;b.Exception.ERROR_PARSING_RESPONSE_CDE=-8;b.Exception.ERROR_PARSING_RESPONSE_MSG="Error_Parsing_Response";b.Exception.ERROR_PARSING_RESPONSE_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.ERROR_PARSING_RESPONSE_CDE+"_"+b.Exception.ERROR_PARSING_RESPONSE_MSG;b.Exception.INVALID_FIELD_CDE=
-9;b.Exception.INVALID_FIELD_MSG="Invalid_Field";b.Exception.INVALID_FIELD_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.INVALID_FIELD_CDE+"_"+b.Exception.INVALID_FIELD_MSG;b.Exception.HTTP_ERROR_CDE=-10;b.Exception.HTTP_ERROR_MSG="HTTP Error";b.Exception.HTTP_ERROR_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.HTTP_ERROR_CDE+"_"+b.Exception.HTTP_ERROR_MSG;b.Exception.INVALID_HIERARCHY_CDE=-11;b.Exception.INVALID_HIERARCHY_MSG="Invalid_Hierarchy";
b.Exception.INVALID_HIERARCHY_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.INVALID_HIERARCHY_CDE+"_"+b.Exception.INVALID_HIERARCHY_MSG;b.Exception.UNEXPECTED_ERROR_READING_MEMBER_CDE=-12;b.Exception.UNEXPECTED_ERROR_READING_MEMBER_MSG="Error_Reading_Member";b.Exception.UNEXPECTED_ERROR_READING_MEMBER_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.UNEXPECTED_ERROR_READING_MEMBER_CDE+"_"+b.Exception.UNEXPECTED_ERROR_READING_MEMBER_MSG;b.Exception.INVALID_AXIS_CDE=
-13;b.Exception.INVALID_AXIS_MSG="The requested axis does not exist.";b.Exception.INVALID_AXIS_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.INVALID_AXIS_CDE+"_"+b.Exception.INVALID_AXIS_MSG;b.Exception.ILLEGAL_ARGUMENT_CDE=-14;b.Exception.ILLEGAL_ARGUMENT_MSG="Illegal arguments";b.Exception.ILLEGAL_ARGUMENT_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.ILLEGAL_ARGUMENT_CDE+"_"+b.Exception.ILLEGAL_ARGUMENT_MSG;b.Exception.ERROR_INSTANTIATING_XMLHTTPREQUEST_CDE=
-15;b.Exception.ERROR_INSTANTIATING_XMLHTTPREQUEST_MSG="Error creating XML Http Request";b.Exception.ERROR_INSTANTIATING_XMLHTTPREQUEST_HLP="http://code.google.com/p/xmla4js/wiki/ExceptionCodes#"+b.Exception.ERROR_INSTANTIATING_XMLHTTPREQUEST_CDE+"_"+b.Exception.ERROR_INSTANTIATING_XMLHTTPREQUEST_MSG;b.Exception._newError=function(a,e,c){return new b.Exception(b.Exception.TYPE_ERROR,b.Exception[a+"_CDE"],b.Exception[a+"_MSG"],b.Exception[a+"_HLP"],e,c)};b.Exception.prototype={type:null,code:null,
message:null,source:null,helpfile:null,data:null,_throw:function(){throw this;},args:null,toString:function(){return this.type+" "+this.code+": "+this.message+" (source: "+this.source+")"},getStackTrace:function(){if(this.args)for(var a=this.args.callee;a;)a=a.caller;return""}};"function"===typeof define&&define.amd?define(function(){return b}):w.Xmla=b;return b})("undefined"===typeof exports?window:exports);
